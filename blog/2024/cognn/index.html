<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Cooperative Graph Neural Networks | Utkarsh Singh </title> <meta name="author" content="Utkarsh Singh"> <meta name="description" content="Some crucial ideas from Finklestein et al.'s work on Cooperative GNNs"> <meta name="keywords" content="physics, preovskite, optical, MLP, neural-network, NN, DFT, ab-initio"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/physics.svg?22c6a264de158c3113076a679b7c31f8"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://utksi.github.io/blog/2024/cognn/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Utkarsh</span> Singh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Cooperative Graph Neural Networks</h1> <p class="post-meta"> Created in May 01, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/mlp"> <i class="fa-solid fa-hashtag fa-sm"></i> MLP</a>   <a href="/blog/tag/neural-network"> <i class="fa-solid fa-hashtag fa-sm"></i> neural-network</a>   ·   <a href="/blog/category/worklog"> <i class="fa-solid fa-tag fa-sm"></i> worklog</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="cooperative-graph-neural-networks-co-gnns">Cooperative Graph Neural Networks (Co-GNNs)</h2> <ul> <li>Proposed by <a href="https://arxiv.org/abs/2310.01267" rel="external nofollow noopener" target="_blank">Finkelstein et al.</a> </li> </ul> <h3 id="framework-overview"><strong>Framework Overview</strong></h3> <p>Co-GNNs introduce a novel, flexible message-passing mechanism where each node in the graph dynamically selects from the actions: <code class="language-plaintext highlighter-rouge">listen</code>, <code class="language-plaintext highlighter-rouge">broadcast</code>, <code class="language-plaintext highlighter-rouge">listen and broadcast</code>, or <code class="language-plaintext highlighter-rouge">isolate</code>. This is facilitated by two cooperating networks:</p> <ol> <li> <strong>Action Network (\(\large{\pi}\))</strong>: Determines the optimal action for each node.</li> <li> <strong>Environment Network (\(\large{\eta}\))</strong>: Updates the node states based on the chosen actions.</li> </ol> <h2 id="mathematical-formulation"><strong>Mathematical Formulation</strong></h2> <ol> <li> <strong>Action Selection (Action Network π)</strong>: <ul> <li>For each node \(\large{v}\) , the action network predicts a probability distribution \(\large{p^{(\ell)}_v}\) over the actions {S, L, B, I} at layer \(\ell\) .</li> </ul> \[p^{(\ell)}_v = \pi \left( h^{(\ell)}_v, \{ h^{(\ell)}_u \mid u \in N_v \} \right)\] <ul> <li>Actions are sampled using the Straight-through Gumbel-softmax estimator.</li> </ul> </li> <li> <strong>State Update (Environment Network η)</strong>: <ul> <li>The environment network updates the node states based on the selected actions.</li> </ul> \[h^{(\ell+1)}_v = \begin{cases} \eta^{(\ell)} \left( h^{(\ell)}_v, \{ \} \right) &amp; \text{if } a^{(\ell)}_v = \text{I or B} \\ \eta^{(\ell)} \left( h^{(\ell)}_v, \{ h^{(\ell)}_u \mid u \in N_v, a^{(\ell)}_u = \text{S or B} \} \right) &amp; \text{if } a^{(\ell)}_v = \text{L or S} \end{cases}\] </li> <li> <strong>Layer-wise Update</strong>: <ul> <li>A Co-GNN layer involves predicting actions, sampling them, and updating node states.</li> <li>Repeated for L layers to obtain final node representations \(\large{h^{(L)}_v}\) .</li> </ul> </li> </ol> <h3 id="environment-network-η-details"><strong>Environment Network η Details</strong></h3> <p>The environment network updates node states using a message-passing scheme based on the selected actions. Let’s consider the standard GCN layer and how it adapts to Co-GNN concepts:</p> <ol> <li> <strong>Message Aggregation</strong>: <ul> <li>For each node v , aggregate messages from its neighbors u that are broadcasting or using the standard action. \(m_v^{(\ell)} = \sum_{u \in N_v, a_u^{(\ell)}\ =\ \text{S or B}} h_u^{(\ell)}\)</li> </ul> </li> <li> <strong>Node Update</strong>: <ul> <li>The node updates its state based on the aggregated messages and its current state. \(h_v^{(\ell+1)} = \sigma \left( W^{(\ell)}_s h_v^{(\ell)} + W^{(\ell)}_n m_v^{(\ell)} \right)\)</li> </ul> </li> </ol> <h3 id="properties-and-benefits"><strong>Properties and Benefits</strong></h3> <ul> <li> <strong>Task-specific</strong>: Nodes learn to focus on relevant neighbors based on the task.</li> <li> <strong>Directed</strong>: Edges can become directed, influencing directional information flow.</li> <li> <strong>Dynamic and Feature-based</strong>: Adapt to changing graph structures and node features.</li> <li> <strong>Asynchronous Updates</strong>: Nodes can be updated independently.</li> <li> <strong>Expressive Power</strong>: More expressive than traditional GNNs, capable of handling long-range dependencies and reducing over-squashing and over-smoothing.</li> </ul> <h3 id="example-implementation"><strong>Example Implementation</strong></h3> <p>Consider a GCN (Graph Convolutional Network) adapted with Co-GNN concepts:</p> <ol> <li> <p><strong>GCN Layer (Traditional)</strong>:</p> \[h^{(\ell+1)}_v = \sigma \left( W^{(\ell)}_s h^{(\ell)}_v + W^{(\ell)}_n \sum_{u \in N_v} h^{(\ell)}_u \right)\] </li> <li> <p><strong>Co-GNN Layer</strong>:</p> <ul> <li> <strong>Action Network</strong>: Predicts action probabilities for each node.</li> </ul> \[p^{(\ell)}_v = \text{Softmax} \left( W_a h^{(\ell)}_v + b_a \right)\] <ul> <li> <p><strong>Action Sampling</strong>: Gumbel-softmax to select actions. \(a^{(\ell)}_v \sim \text{Gumbel-Softmax}(p^{(\ell)}_v)\)</p> </li> <li> <p><strong>State Update (Environment Network)</strong>:</p> </li> </ul> \[h^{(\ell+1)}_v = \begin{cases} \sigma \left( W^{(\ell)}_s h^{(\ell)}_v \right) &amp; \text{if } a^{(\ell)}_v = \text{I or B} \\ \sigma \left( W^{(\ell)}_s h^{(\ell)}_v + W^{(\ell)}_n \sum_{u \in N_v, a^{(\ell)}_u = \text{S or B}} h^{(\ell)}_u \right) &amp; \text{if } a^{(\ell)}_v = \text{L or S} \end{cases}\] </li> </ol> <h2 id="conclusion">Conclusion</h2> <p>Co-GNNs represent a significant advancement in GNN architectures, offering a dynamic and adaptive message-passing framework that improves the handling of complex graph structures and long-range dependencies. The introduction of the Action Network and Environment Network provides a more flexible and task-specific approach to node state updates, leading to superior performance on various graph-related tasks.</p> <p>For further details, refer to the <a href="https://arxiv.org/abs/2310.01267" rel="external nofollow noopener" target="_blank">manuscript</a>.</p> <h2 id="integrating-co-gnn-concepts-into-mace">Integrating Co-GNN Concepts into MACE</h2> <h3 id="1-node-representation"><strong>1. Node Representation</strong></h3> <p>Each node i is represented by:</p> \[\large{\sigma_i^{(t)} = (r_i, z_i, h_i^{(t)})}\] <p>where \(r_i \in \mathbb{R}^3\) is the position, \(z_i\) is the chemical element, and \(h_i^{(t)}\) are the learnable features at layer \(t\).</p> <h4 id="2-action-network-π"><strong>2. Action Network (π)</strong></h4> <p>For each atom i at layer t, the Action Network \(\pi\) predicts a probability distribution over actions {S, L, B, I}:</p> \[\large{p_i^{(t)} = \pi(\sigma_i^{(t)}, \{\sigma_j^{(t)} | j \in N(i)\})}\] <h4 id="3-action-sampling"><strong>3. Action Sampling</strong></h4> <p>Actions are sampled using the Straight-through Gumbel-softmax estimator:</p> \[\large{a_i^{(t)} \sim \text{Gumbel-Softmax}(p_i^{(t)})}\] <h4 id="4-message-construction"><strong>4. Message Construction</strong></h4> <p>Messages are constructed hierarchically using body order expansion, modified to consider only neighbors that are broadcasting (B) or using the standard action (S):</p> \[\large{m_i^{(t)} = \sum_{j \in N(i), a_j^{(t)} \in \{S, B\}} u_1(\sigma_i^{(t)}, \sigma_j^{(t)}) + \sum_{j_1, j_2 \in N(i), a_{j_1}^{(t)} \in \{S, B\}, a_{j_2}^{(t)} \in \{S, B\}} u_2(\sigma_i^{(t)}, \sigma_{j_1}^{(t)}, \sigma_{j_2}^{(t)}) + \cdots + \sum_{j_1, \ldots, j_\nu \in N(i), a_{j_1}^{(t)} \in \{S, B\}, \ldots, a_{j_\nu}^{(t)} \in \{S, B\}} u_\nu(\sigma_i^{(t)}, \sigma_{j_1}^{(t)}, \ldots, \sigma_{j_\nu}^{(t)})}\] <p>For the two-body interactions:</p> \[\large{A_i^{(t)} = \sum_{j \in N(i), a_j^{(t)} \in \{S, B\}} R_{kl_1l_2l_3}^{(t)}(r_{ij}) Y_{l_1}^{m_1}(\hat{r}_{ij}) W_{kk_2l_2}^{(t)} h_{j,k_2l_2m_2}^{(t)}}\] <p>where R is a learnable radial basis, Y are spherical harmonics, and W are learnable weights.</p> <h4 id="5-higher-order-feature-construction"><strong>5. Higher-order Feature Construction</strong></h4> <p>Higher-order features are constructed using tensor products and symmetrization, modified to consider the actions of neighboring atoms:</p> \[\large{B_{i, \eta \nu k LM}^{(t)} = \sum_{lm} C_{LM \eta \nu, lm} \prod_{\xi=1}^\nu \sum_{k_\xi} w_{kk_\xi l_\xi}^{(t)} A_{i, k_\xi l_\xi m_\xi}^{(t)}}\] <p>where C are generalized Clebsch-Gordan coefficients.</p> <h4 id="6-state-update-environment-network-η"><strong>6. State Update (Environment Network η)</strong></h4> <p>The state update is modified based on the sampled actions:</p> <ul> <li>If \(a_i^{(t)} \in \{L, S\}\):</li> </ul> \[\large{h_i^{(t+1)} = \eta^{(t)}(h_i^{(t)}, \{h_j^{(t)} | j \in N(i), a_j^{(t)} \in \{S, B\}\})}\] <ul> <li>If \(a_i^{(t)} \in \{I, B\}\):</li> </ul> \[\large{h_i^{(t+1)} = \eta^{(t)}(h_i^{(t)}, \{\})}\] <h4 id="7-readout-phase"><strong>7. Readout Phase</strong></h4> <p>In the readout phase, invariant features are mapped to site energies:</p> \[\large{E_i = E_i^{(0)} + E_i^{(1)} + \cdots + E_i^{(T)}}\] <p>where:</p> \[\large{E_i^{(t)} = R_t(h_i^{(t)}) = \sum_{k'} W_{\text{readout}, k'}^{(t)} h_{i, k' 00}^{(t)} \quad \text{for } t &lt; T}\] \[\large{E_i^{(T)} = \text{MLP}_{\text{readout}}^{(t)}(\{h_{i, k 00}^{(t)}\})}\] <h4 id="8-equivariance"><strong>8. Equivariance</strong></h4> <p>The model ensures equivariance under rotation \(Q \in O(3)\) :</p> \[\large{h_i^{(t)}(Q \cdot (r_1, \ldots, r_N)) = D(Q) h_i^{(t)}(r_1, \ldots, r_N)}\] <p>where \(D(Q)\) is a Wigner D-matrix. For feature \(\large{h_{i, k LM}^{(t)}}\) , it transforms as:</p> \[\large{h_{i, k LM}^{(t)}(Q \cdot (r_1, \ldots, r_N)) = \sum_{M'} D_L(Q)_{M'M} h_{i, k LM'}^{(t)}(r_1, \ldots, r_N)}\] <h2 id="2-conclusion">(2) Conclusion</h2> <p>By incorporating the dynamic message-passing strategy of Co-GNNs into the MACE framework, we can enhance its flexibility and adaptability. This involves using an Action Network to determine the message-passing strategy for each atom, modifying the message construction and state update equations accordingly. This integration retains the equivariance properties of MACE while potentially improving its expressiveness and ability to capture complex interactions(?).</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Utkarsh Singh. Last updated: January 30, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>